
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Theoretical background &#8212; PyMieSim 0.1.11 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css" />
    <link rel="stylesheet" type="text/css" href="_static/default.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
        <div style="background-color: gray; text-align: left; padding: 10px 10px 15px 15px">
        <a href="index.html"><h1 style="font-size: 3em;">PyMieSim</h1></a>
        </div>
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="#">Theory</a>|&nbsp;</li>
        <li><a href="Code.html">Code</a>|&nbsp;</li>
        <li><a href="Examples.html">Examples</a>|&nbsp;</li>
        <li><a href="Material.html">Material</a>|&nbsp;</li>
        <li><a href="LPModes.html">LPModes</a>|&nbsp;</li>
        <li><a href="References.html">References</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>

        <li class="nav-item nav-item-this"><a href="">Theoretical background</a></li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="theoretical-background">
<h1>Theoretical background<a class="headerlink" href="#theoretical-background" title="Permalink to this headline">¶</a></h1>
<section id="lorenz-mie-theory-lmt">
<h2>Lorenz-Mie Theory (LMT)<a class="headerlink" href="#lorenz-mie-theory-lmt" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Lorenz-Mie Theory or (LMT for short) is a framework that can be used to find
exact solution of the scattered field considering a plane wave incident to a
scatterer with a certain geometry.
The solution is usually written in the form of an infinite summation which, of
course, has to be truncated. PyMieSim is a library which does solve the
equations in order to retrieve plenty of important informations.
It is to be noted that in all the library, the angles <span class="math notranslate nohighlight">\(\theta\)</span> and
<span class="math notranslate nohighlight">\(\phi\)</span> are defined as in a spherical coordinate system as shown in the
following figure.</p>
<a class="reference internal image-reference" href="_images/opticalSetup.png"><img alt="_images/opticalSetup.png" src="_images/opticalSetup.png" style="width: 600px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here are few of the most important relations governing the PyMieSim library.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}&amp;S_1=\sum\limits_{n=1}^{n_{max}}\frac{2n+1}{n(n+1)}(a_n\pi_n+b_n\tau_n)\\&amp;.\\&amp;S_2=\sum\limits_{n=1}^{n_{max}}\frac{2n+1}{n(n+1)}(a_n\tau_n+b_n\pi_n)\\.&amp;\\&amp;\text{Fields} = E_{\theta}(\phi,\theta) \vec{\theta} +   E_{\phi}(\phi,\theta) \vec{\phi}\\.&amp;\\&amp;\text{SPF} = \sqrt{ E_{\parallel}(\phi,\theta)^2 + E_{\perp}(\phi,\theta)^2 }\end{aligned}\end{align} \]</div>
<p><strong>Stokes parameters:</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}&amp;I = \big| E_x \big|^2 + \big| E_y \big|^2\\.&amp;\\&amp;Q = \big| E_x \big|^2 - \big| E_y \big|^2\\.&amp;\\&amp;U = 2 \mathcal{Re} \big\{ E_x E_y^* \big\}\\.&amp;\\&amp;V = 2 \mathcal{Im} \big\{ E_x E_y^* \big\}\end{aligned}\end{align} \]</div>
</div></blockquote>
</div>
</section>
<section id="scattering-properties">
<h2>Scattering properties<a class="headerlink" href="#scattering-properties" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are many properties of the scatterer that might be useful to know such as:
- scattering efficiency
- extinction efficiency
- absorption efficiency
- back-scattering efficiency
- ratio of front and back scattering
- optical pressure efficiency
- anisotropy factor g</p>
<p>Those parameters can be computed using PyMieSim according to those equations.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}&amp;Q_{sca} = \frac{2}{x^2}\sum_{n=1}^{n_{max}}(2n+1)(|a_n|^2+|b_n|^2)\\&amp;Q_{ext} = \frac{2}{x^2} \sum_{n=1}^{n_{max}} (2n+1) \mathcal Re \{ a_n+b_n \}\\&amp;Q_{abs} = Q_{ext}-Q_{sca}\\&amp;Q_{back} = \frac{1}{x^2} \Big| \sum\limits_{n=1}^{n_{max}} (2n+1)(-1)^n (a_n - b_n) \Big|^2\\&amp;Q_{ratio} = \frac{Q_{back}}{Q_{sca}}\\&amp;Q_{pr} = Q_{ext} - g * Q_{sca}\\&amp;g = \frac{4}{Q_{sca} x^2}
        \Big[ \sum\limits_{n=1}^{n_{max}} \frac{n(n+2)}{n+1} \text{Re} \left\{ a_n a_{n+1}^* + b_n b_{n+1}^*\right\} +
        \sum\limits_{n=1}^{n_{max}} \frac{2n+1}{n(n+1)} \text{Re}\left\{ a_n b_n^* \right\} \Big]\\&amp;A_s = \pi r^2\\&amp;\sigma_{i} = Q_{i} A\\&amp;\mu_{sca} = \sigma_{sca} C\\&amp;\mu_{ext} = \sigma_{ext} C\\&amp;\mu_{abs} = \sigma_{abs} C\end{aligned}\end{align} \]</div>
<div class="line-block">
<div class="line">With:</div>
<div class="line-block">
<div class="line">C: the scatterer concentration in the sample.</div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="an-and-bn-coefficients">
<h2>An and Bn coefficients:<a class="headerlink" href="#an-and-bn-coefficients" title="Permalink to this headline">¶</a></h2>
<p>From the An and Bn coefficients, we can retrieve many useful properties of
the scatterer and scattered far-fields. Those are complementary to the
Cn and Dn coefficient (for near-field properties) which we do no compute
with PyMieSim at the moment.
Depending on the scatterer geometry, all those coefficient may vary. Here we
have three example which are available with the PyMieSim library.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Sphere</strong></p>
<div class="math notranslate nohighlight">
\[a_n = \frac{
\mu_{sp} \Psi_n(x) \Psi_n^\prime(M x) - \mu M \Psi_n^\prime(x) \Psi_n(M x)}
{\mu_{sp} \xi_n(x) \Psi_n^\prime(M x)- \mu M \xi_n^\prime (x) \Psi_n(M x)}\]</div>
<div class="math notranslate nohighlight">
\[b_n = \frac{
 \mu M \Psi_n(x) \Psi_n^\prime(M x) - \mu_{sp} \Psi_n^\prime(x) \Psi_n(M x)}
{\mu M \xi_n(x) \Psi_n^\prime(M x) - \mu_{sp} \xi_n^\prime (x) \Psi_n(M x)}\]</div>
<div class="line-block">
<div class="line-block">
<div class="line">With:</div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(\psi_n = x \psi^{(1)}_n (x) = \sqrt{x \pi/2} J_{n+1/2} (x)\)</span>.</div>
<div class="line"><span class="math notranslate nohighlight">\(M = k_{sp}/k\)</span> is the relative complex refractive index.</div>
<div class="line"><span class="math notranslate nohighlight">\(x = \pi d / \lambda\)</span>.</div>
<div class="line"><span class="math notranslate nohighlight">\(\lambda\)</span> is the wavelength in the surrounding medium.</div>
<div class="line"><a class="reference internal" href="References.html#references"><span class="std std-ref">References</span></a> [1] Eq(III.88-91).</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="line"><strong>important</strong>: It is to be noted that PyMieSim assume <span class="math notranslate nohighlight">\(\mu_{sp} = \mu\)</span> at the moment.
It might change in a future update.</div>
</div>
</div>
<hr class="docutils" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Cylinder</strong></p>
<div class="math notranslate nohighlight">
\[a_n = \frac{ M J_n(M x) J_n^\prime (m x) - m J_n^\prime (M x) J_n(m x) }
{ m_t J_n(M x) H_n^\prime (m x) - m J_n^\prime (M x) H_n(m x) }\]</div>
<div class="math notranslate nohighlight">
\[b_n = \frac{ m J_n(m_t x) J_n^\prime (m x) - m_t J_n^\prime (m_t x) J_n(m x) }
{ m J_n(m_t x) H_n^\prime (m x) - m_t J_n^\prime (m_t x) H_n(m x) }\]</div>
<div class="line-block">
<div class="line">With:</div>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(M\)</span> is the refractive index of the scatterer.</div>
<div class="line"><span class="math notranslate nohighlight">\(m\)</span> is the refractive index of the medium.</div>
<div class="line"><span class="math notranslate nohighlight">\(H_n\)</span> is the Hankel function of first kind of order n.</div>
<div class="line"><a class="reference internal" href="References.html#references"><span class="std std-ref">References</span></a> [5] Eq(8.30-32).</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Core/Shell sphere</strong></p>
<div class="math notranslate nohighlight">
\[a_n = \frac{
\psi_n \left[ \psi_n' (m_2 y) - A_n \chi_n' (m_s) \right] -
m_2 \psi_n'(y) \left[ \psi_n (m_2 y) - A_n \chi_n (m_2 y) \right]}
{\xi_n (y) \left[ \psi_n' (m_2 y) -A_n \chi_n' (m_2 y) \right] -
m_2 \xi_n' (y) \left[ \psi_n(m_2 y) - A_n \chi_n (m_2 y) \right]}\]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}b_n = \frac{
  m_2 \psi_n(y) \left[ \psi_n' (m_2 y) - B_n \chi_n' (m_2 y) \right] -
  \psi_n' (y) \left[ \psi_n (m_2 y) - B_n \chi_n (m_2 y) \right]}
  {m_2 \xi_n(y) \left[ \psi_n' (m_2 y) - B_n \xi_n' (m_2 y) \right] -
  \xi_n' \left[ \psi_n (m_2 y) -A_n \chi_n (m_2 y)  \right]\\  }\end{aligned}\end{align} \]</div>
<div class="line-block">
<div class="line">With:</div>
</div>
<div class="math notranslate nohighlight">
\[A_n = \frac{ m_2 \psi_n (m_2 x) \psi_n' (m_1 x) - m1 \psi_n'(m_2 x) \psi_n(m_1x)}
  {m_2 \xi_n (m_2x) \psi_n' (m_1 x) - m_1 \xi_n' (m_2 x) \psi_n (m_1 x)}\]</div>
<div class="math notranslate nohighlight">
\[B_n = \frac{m_2 \psi_n (m_1 x) \psi_n' (m_2 x) - m_1 \psi_n (m_2 x) \psi_n' (m_1 x)}
  {m_2 \chi_n' (m_2 x) \psi_n (m_1 x) - m_1 \psi_n' (m_1 x) \chi_n (m_2 x)}\]</div>
<div class="line-block">
<div class="line">and:</div>
</div>
<div class="math notranslate nohighlight">
\[x = \frac{2 \pi R_{core}}{\lambda}, \:
y = \frac{2 \pi R_{shell}}{\lambda}, \:
m_1 = \frac{n_{core}}{n_{medium}}, \:
m_2 = \frac{n_{shell}}{n_{medium}}.\]</div>
<div class="math notranslate nohighlight">
\[\chi_n (x) = -x\sqrt{\frac{\pi}{2x}} N_{n+1/2} (x) \leftarrow \text{Neumann}\]</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="References.html#references"><span class="std std-ref">References</span></a> [8] Eq(4-5).</div>
</div>
</div>
</section>
<section id="generalized-lorenz-mie-theory-glmt">
<h2>Generalized Lorenz-Mie Theory (GLMT)<a class="headerlink" href="#generalized-lorenz-mie-theory-glmt" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Coming soon</strong></p>
</div>
</section>
<hr class="docutils" />
<section id="coupling-mechanism">
<h2>Coupling mechanism<a class="headerlink" href="#coupling-mechanism" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are two main coupling mechanisms, <strong>coherent coupling</strong> and non-coherent coupling.
For instance, photodiode collect light via a <strong>non-coherent mechanism</strong>. On the other part,
fiber optic LP mode collects light in a coherent way and as such they usually
collect a lot less light but they add additional information on the sample studied.</p>
<p>Mathematically they are defined as follows:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}C_{coh.} &amp;= \Big| \iint_{\Omega}  \Phi_{det} \, . \, \Psi_{scat}^* \,  d \Omega \Big|^2\\C_{Noncoh.} &amp;=  \iint_{\Omega}  \Big| \Phi_{det} \Big|^2 \,.\, \Big| \Psi_{scat} \Big|^2 \,  d \Omega\end{aligned}\end{align} \]</div>
<p>It is to be noted that the <strong>coherent coupling</strong> definition is derived from the coupled mode theory
which remains true as long as the parallax approximation is also true.
Furthermore, this coupling is what we would call <strong>centered coupling</strong>. It means that the
scatterer is perfectly centered with the detector. Even though it doesn’t affect
so much the <strong>non-coherent coupling</strong> coupling, it can largely affect <strong>coherent coupling</strong>.</p>
<p>To take into account the effect of transversal offset of the scatterer, we define
the footprint of the scatterer.</p>
<div class="math notranslate nohighlight">
\[\eta_{l,m}(\delta_x, \delta_y) = \Big| \mathcal{F}^{-1} \big\{ \Phi_{det} \, . \, \Psi_{scat} \big\}  \Big|^2\]</div>
<p>Thus, we can compute the <strong>mean coupling</strong> as the mean value of <span class="math notranslate nohighlight">\(\eta_{l,m}\)</span></p>
<div class="math notranslate nohighlight">
\[\widetilde{\eta}_{l,m} = \big&lt; \eta_{l,m}(\delta_x, \delta_y) \big&gt;\]</div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/Logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Theoretical background</a><ul>
<li><a class="reference internal" href="#lorenz-mie-theory-lmt">Lorenz-Mie Theory (LMT)</a></li>
<li><a class="reference internal" href="#scattering-properties">Scattering properties</a></li>
<li><a class="reference internal" href="#an-and-bn-coefficients">An and Bn coefficients:</a></li>
<li><a class="reference internal" href="#generalized-lorenz-mie-theory-glmt">Generalized Lorenz-Mie Theory (GLMT)</a></li>
<li><a class="reference internal" href="#coupling-mechanism">Coupling mechanism</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Theory.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="#">Theory</a>|&nbsp;</li>
        <li><a href="Code.html">Code</a>|&nbsp;</li>
        <li><a href="Examples.html">Examples</a>|&nbsp;</li>
        <li><a href="Material.html">Material</a>|&nbsp;</li>
        <li><a href="LPModes.html">LPModes</a>|&nbsp;</li>
        <li><a href="References.html">References</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>

        <li class="nav-item nav-item-this"><a href="">Theoretical background</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Martin Poinsinet de Sivry-Houle.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
    </div>
  </body>
</html>